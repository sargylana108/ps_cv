
# Обнаружение растительности в охранных зонах линий электропередач

## Описание задачи

Проект посвящен разработке алгоритма компьютерного зрения для анализа облаков точек с целью:
- Обнаружения растительности (деревья и кустарники), угрожающей линиям электропередач в охранных зонах.
- Классификации объектов инфраструктуры линий электропередач: опор промежуточного и анкерного типов.

---

## Классы объектов для предсказания

Алгоритм классифицирует объекты в облаке точек на три типа:
1. **LEP_anchor** (анкерная опора): металлические конструкции, поддерживающие провода.
2. **LEP_prom** (промежуточная опора): элементы, стабилизирующие провода на промежуточных расстояниях.
3. **vegetation** (растительность): деревья и кустарники высотой от 1 метра, представляющие угрозу линиям электропередач.

---

## Подход к решению

1. **Модель**: Использованы две архитектуры — базовая PointNet и PointNet++ объединяющая элементы DGCNN, Transformer и т.д. 
2. **Аугментация данных**: Реализованы методы для искусственного увеличения данных через вращения, масштабирование и добавление шума.
3. **Обучение**: Используется оптимизатор AdamW с циклическим изменением скорости обучения. Для оценки качества модели применяется метрика Mean Average Precision (mAP).
4. **Постобработка**: Прогнозируемые объекты фильтруются по минимальным размерам и пороговым значениям уверенности.

---

## Формат данных

### Входные данные
Облака точек в формате `.las`.

### Выходной файл
CSV-файл с колонками:
- `id`: Уникальный идентификатор объекта.
- `file_name`: Имя входного файла.
- `center_x, center_y, center_z`: Центр объекта в GPS-координатах.
- `size_x, size_y, size_z`: Размеры объекта в метрах.
- `yaw`: Угол ориентации объекта.
- `class`: Класс объекта (`LEP_anchor`, `LEP_prom`, `vegetation`).
- `score`: Уровень уверенности модели (0–1).

Пример строки:
```
1,Day1_november.las,34.052235,-118.243683,200.5,15.0,15.0,50.0,45,LEP_anchor,0.92
```

---

## Использование

### 1. Обучение модели
- Настройте параметры модели вначале ноутбука.
- Запустите обучение, лучие модели будут сохраняться.

### 2. Предсказание
- Выберите и загрузите обученную модель.
- Результаты предсказания сохранятся в настроенный `OUTPUT_CSV`.

---

## Примечания

В папке `models` размещены обученные модели PointNet и PointNet++. Предсказания PointNet++ пока не были выполнены (при обучении на валидационной выборке mAP: 0.8902).

---

## Источники

Anton Egorov and Dzhavid Sadreddinov. Power Line Security Zone Vegetation Detection. https://kaggle.com/competitions/power-line-security-zone-vegetation-detection, 2024. Kaggle.

---
